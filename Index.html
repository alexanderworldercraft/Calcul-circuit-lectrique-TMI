<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Calculateur de circuits</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f9f9f9; }
    h1 { color: #333; }
    .section { margin-bottom: 20px; }
    label, input, button { margin: 5px; }
    input { width: 80px; }
    .results { margin-top: 20px; background: #fff; padding: 10px; border: 1px solid #ccc; }
    .parallel-group { margin-bottom: 10px; border: 1px solid #ccc; padding: 10px; }
  </style>
</head>
<body>

  <h1>üßÆ Calculateur de circuits √©lectriques</h1>

  <div class="section">
    <label>Tension U (Volts) :</label>
    <input type="number" id="tension" placeholder="ex: 24">
  </div>

  <div class="section">
    <h2>üîó R√©sistances en s√©rie</h2>
    <div id="serieInputs"></div>
    <button onclick="addResistance('serie')">+ Ajouter r√©sistance s√©rie</button>
  </div>

  <div class="section">
    <h2>‚õìÔ∏è Zones en parall√®le</h2>
    <div id="parallelGroups">
      <div class="parallel-group" id="group1">
        <h3>Groupe 1</h3>
        <div id="paralleleInputs1"></div>
        <button onclick="addResistance('parallele', 1)">+ Ajouter r√©sistance parall√®le</button>
      </div>
    </div>
    <button onclick="addParallelGroup()">+ Ajouter un autre groupe parall√®le</button>
  </div>

  <div class="section">
    <button onclick="calculer()">‚ö° Calculer</button>
    <button onclick="reset()">üîÑ R√©initialiser</button>
  </div>

  <div class="results" id="resultats"></div>

  <script>
    // Ajout de champs dynamiques pour les r√©sistances
    function addResistance(type, groupId = 0) {
      const container = groupId > 0 
        ? document.getElementById('paralleleInputs' + groupId)
        : document.getElementById('serieInputs');
      const input = document.createElement('input');
      input.type = 'number';
      input.placeholder = 'R en Œ©';
      input.className = type;
      container.appendChild(input);
    }

    // Ajout d'un groupe parall√®le
    function addParallelGroup() {
      const groupCount = document.querySelectorAll('.parallel-group').length + 1;
      const groupDiv = document.createElement('div');
      groupDiv.className = 'parallel-group';
      groupDiv.id = 'group' + groupCount;
      groupDiv.innerHTML = `
        <h3>Groupe ${groupCount}</h3>
        <div id="paralleleInputs${groupCount}"></div>
        <button onclick="addResistance('parallele', ${groupCount})">+ Ajouter r√©sistance parall√®le</button>
      `;
      document.getElementById('parallelGroups').appendChild(groupDiv);
    }

    // Fonction de calcul
    function calculer() {
      const U = parseFloat(document.getElementById('tension').value) || 0;

      // R√©cup√©ration des r√©sistances s√©rie
      const Rs = [...document.querySelectorAll('.serie')].map(el => parseFloat(el.value)).filter(v => !isNaN(v));
      const parallelGroups = document.querySelectorAll('.parallel-group');
      
      // Calcul de la r√©sistance √©quivalente des groupes parall√®les
      let Req = 0;
      let totalParallelResistance = 0;
      let totalI = 0;
      
      // Calcul des r√©sistances en s√©rie
      const ReqSerie = Rs.reduce((acc, val) => acc + val, 0);

      // Parcours des groupes parall√®les
      parallelGroups.forEach((group, idx) => {
        const Rp = [...group.querySelectorAll('.parallele')].map(el => parseFloat(el.value)).filter(v => !isNaN(v));
        if (Rp.length > 0) {
          const ReqParallele = 1 / Rp.reduce((acc, val) => acc + (1 / val), 0);
          totalParallelResistance += ReqParallele;
        }
      });

      // R√©sistance √©quivalente totale
      Req = ReqSerie + totalParallelResistance;
      const I_total = Req > 0 ? (U / Req) : 0;

      // Calcul de la tension sur les r√©sistances en s√©rie
      const Us_serie = Rs.map(R => (I_total * R).toFixed(2));

      // Calcul de la tension restante pour chaque groupe parall√®le
      let results = '';
      parallelGroups.forEach((group, idx) => {
        const Rp = [...group.querySelectorAll('.parallele')].map(el => parseFloat(el.value)).filter(v => !isNaN(v));
        const U_restant = Rs.length > 0 ? (U - Us_serie.reduce((acc, val) => acc + parseFloat(val), 0)).toFixed(2) : U;

        const Is_parallele = Rp.map(R => (U_restant / R).toFixed(2));

        results += `
          <p><strong>Groupe ${idx + 1} en parall√®le :</strong></p>
          <ul>
            ${Rp.map((R, i) => `<li>R${i + 1} = ${R} Œ© ‚Üí U = ${U_restant} V, I = ${Is_parallele[i]} A</li>`).join('')}
          </ul>
        `;
      });

      const output = document.getElementById('resultats');
      output.innerHTML = `
        <p><strong>R√©sistance √©quivalente (Req) :</strong> ${Req.toFixed(2)} Œ©</p>
        <p><strong>Courant total (I) :</strong> ${I_total.toFixed(2)} A</p>

        ${Rs.length ? `
          <p><strong>R√©sistances en s√©rie :</strong></p>
          <ul>
            ${Rs.map((R, i) => `<li>R${i + 1} = ${R} Œ© ‚Üí U = ${Us_serie[i]} V, I = ${I_total.toFixed(2)} A</li>`).join('')}
          </ul>` : ''}

        ${results}
      `;
    }

    // Fonction pour r√©initialiser tous les champs
    function reset() {
      // R√©initialisation des champs de tension et r√©sistances
      document.getElementById('tension').value = '';
      document.getElementById('serieInputs').innerHTML = '';
      document.getElementById('parallelGroups').innerHTML = `
        <div class="parallel-group" id="group1">
          <h3>Groupe 1</h3>
          <div id="paralleleInputs1"></div>
          <button onclick="addResistance('parallele', 1)">+ Ajouter r√©sistance parall√®le</button>
        </div>
      `;
      // R√©initialisation des r√©sultats
      document.getElementById('resultats').innerHTML = '';
    }
  </script>

</body>
</html>
